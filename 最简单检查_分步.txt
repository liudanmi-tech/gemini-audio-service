# ============================================
# 最简单检查 - 分步执行（避免安全拦截）
# ============================================

# 步骤1：检查文件
cd /home/admin/gemini-audio-service && ls -l main.py

# 步骤2：查看函数定义（只看一行）
cd /home/admin/gemini-audio-service && grep "async def analyze_audio_async" main.py | head -1

# 步骤3：查看函数调用（只看一行）
cd /home/admin/gemini-audio-service && grep "asyncio.create_task(analyze_audio_async" main.py | head -1

# 步骤4：检查语法
cd /home/admin/gemini-audio-service && python3 -c "import py_compile; py_compile.compile('main.py', doraise=True)" && echo "语法OK" || echo "语法错误"

# 步骤5：测试服务（3秒后停止）
cd /home/admin/gemini-audio-service && timeout 3 python3 main.py 2>&1 | head -3

