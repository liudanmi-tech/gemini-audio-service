# éŸ³é¢‘åˆ†ææœåŠ¡ v0.2 æŠ€æœ¯æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: v0.2  
**åˆ›å»ºæ—¥æœŸ**: 2026-01-14  
**æœ€åæ›´æ–°**: 2026-01-15  
**çŠ¶æ€**: âœ… å‰åç«¯å·²è”é€šï¼ŒåŠŸèƒ½æ­£å¸¸ï¼ŒæœåŠ¡ç¨³å®šè¿è¡Œ  
**æ–°å¢åŠŸèƒ½**: âœ… å›¾ç‰‡ç”Ÿæˆä¸æ˜¾ç¤ºï¼ˆGemini Nano Banana + OSSï¼‰

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¶æ„æ€»è§ˆ](#1-ç³»ç»Ÿæ¶æ„æ€»è§ˆ)
2. [æŠ€æœ¯æ ˆé€‰å‹](#2-æŠ€æœ¯æ ˆé€‰å‹)
3. [æŠ€æœ¯é“¾è·¯æµç¨‹](#3-æŠ€æœ¯é“¾è·¯æµç¨‹)
4. [åŠŸèƒ½æè¿°](#4-åŠŸèƒ½æè¿°)
5. [API æ¥å£æ–‡æ¡£](#5-api-æ¥å£æ–‡æ¡£)
6. [æ•°æ®æ¨¡å‹](#6-æ•°æ®æ¨¡å‹)
7. [äº¤äº’é“¾è·¯](#7-äº¤äº’é“¾è·¯)
8. [å‰ç«¯æŠ€æœ¯å®ç°](#8-å‰ç«¯æŠ€æœ¯å®ç°)
9. [åç«¯æŠ€æœ¯å®ç°](#9-åç«¯æŠ€æœ¯å®ç°)
10. [éƒ¨ç½²é…ç½®](#10-éƒ¨ç½²é…ç½®)
11. [å…³é”®é—®é¢˜è§£å†³æ–¹æ¡ˆ](#11-å…³é”®é—®é¢˜è§£å†³æ–¹æ¡ˆ)

---

## 1. ç³»ç»Ÿæ¶æ„æ€»è§ˆ

### 1.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    iOS å®¢æˆ·ç«¯ (SwiftUI)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  å½•éŸ³æ¨¡å—    â”‚  â”‚  ä»»åŠ¡åˆ—è¡¨    â”‚  â”‚  ä»»åŠ¡è¯¦æƒ…    â”‚    â”‚
â”‚  â”‚  âœ… å·²å®ç°   â”‚  â”‚  âœ… å·²å®ç°   â”‚  â”‚  âœ… å·²å®ç°   â”‚    â”‚
â”‚  â”‚  AudioRecorderâ”‚  â”‚  TaskList   â”‚  â”‚  TaskDetail  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                  â”‚                  â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                            â”‚                                â”‚
â”‚                    NetworkManager                           â”‚
â”‚                    (Alamofire)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP (Alamofire)
                            â”‚ BaseURL: http://47.79.254.213:8001/api/v1
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FastAPI åç«¯æœåŠ¡ (Python 3.12)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Uvicorn ASGI Server                              â”‚   â”‚
â”‚  â”‚  Port: 8001                                       â”‚   â”‚
â”‚  â”‚  Host: 0.0.0.0                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  API Endpoints:                                   â”‚   â”‚
â”‚  â”‚  POST /api/v1/audio/upload (ä¸Šä¼ éŸ³é¢‘)            â”‚   â”‚
â”‚  â”‚  GET  /api/v1/tasks/sessions (ä»»åŠ¡åˆ—è¡¨)          â”‚   â”‚
â”‚  â”‚  GET  /api/v1/tasks/sessions/{id} (ä»»åŠ¡è¯¦æƒ…)     â”‚   â”‚
â”‚  â”‚  GET  /api/v1/tasks/sessions/{id}/status (çŠ¶æ€)  â”‚   â”‚
â”‚  â”‚  POST /api/v1/tasks/sessions/{id}/strategies     â”‚   â”‚
â”‚  â”‚  GET  /api/v1/images/{session_id}/{index}       â”‚   â”‚
â”‚  â”‚  GET  /health (å¥åº·æ£€æŸ¥)                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å†…å­˜å­˜å‚¨:                                        â”‚   â”‚
â”‚  â”‚  - tasks_storage: ä»»åŠ¡æ•°æ®                        â”‚   â”‚
â”‚  â”‚  - analysis_storage: åˆ†æç»“æœ                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å›¾ç‰‡ç”Ÿæˆä¸å­˜å‚¨:                                  â”‚   â”‚
â”‚  â”‚  - Gemini Nano Banana: å›¾ç‰‡ç”Ÿæˆ                  â”‚   â”‚
â”‚  â”‚  - é˜¿é‡Œäº‘ OSS: å›¾ç‰‡å­˜å‚¨                          â”‚   â”‚
â”‚  â”‚  - è‡ªåŠ¨é‡è¯•æœºåˆ¶: é…é¢é”™è¯¯å¤„ç†                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP (åå‘ä»£ç†)
                            â”‚ Proxy: http://47.79.254.213/secret-channel
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Nginx åå‘ä»£ç†æœåŠ¡å™¨                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æœåŠ¡å™¨: 47.79.254.213 (é˜¿é‡Œäº‘æ–°åŠ å¡)                â”‚   â”‚
â”‚  â”‚  è·¯å¾„: /secret-channel                              â”‚   â”‚
â”‚  â”‚  åŠŸèƒ½: è½¬å‘è¯·æ±‚åˆ° Google Gemini API                â”‚   â”‚
â”‚  â”‚  é…ç½®: SSL ä»£ç†ï¼Œæ”¯æŒå¤§æ–‡ä»¶ä¸Šä¼                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTPS
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Google Gemini 3 Flash API                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ¨¡å‹: gemini-3-flash-preview                      â”‚   â”‚
â”‚  â”‚  åŠŸèƒ½: éŸ³é¢‘ä¸Šä¼ ã€è½¬å†™ã€åˆ†æ                        â”‚   â”‚
â”‚  â”‚  è¾“å‡º: å¯¹è¯æå–ã€æƒ…ç»ªåˆ†æã€é£é™©è¯†åˆ«                 â”‚   â”‚
â”‚  â”‚  SDK: google-generativeai 0.8.6                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTPS (google.genai SDK)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Google Gemini Nano Banana Image API              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ¨¡å‹: gemini-2.5-flash-image                      â”‚   â”‚
â”‚  â”‚  åŠŸèƒ½: æ–‡æœ¬ç”Ÿæˆå›¾ç‰‡ï¼ˆç«æŸ´äººåŠ¨ç”»ï¼‰                    â”‚   â”‚
â”‚  â”‚  è¾“å‡º: PNG å›¾ç‰‡ (1184x864, 4:3)                    â”‚   â”‚
â”‚  â”‚  SDK: google-genai 0.2.0+                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ å›¾ç‰‡ä¸Šä¼ 
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              é˜¿é‡Œäº‘ OSS (Object Storage Service)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Bucket: geminipicture2                            â”‚   â”‚
â”‚  â”‚  Endpoint: oss-cn-beijing.aliyuncs.com            â”‚   â”‚
â”‚  â”‚  è·¯å¾„: images/{session_id}/{image_index}.png       â”‚   â”‚
â”‚  â”‚  è®¿é—®: é€šè¿‡åç«¯ API ä»£ç†è®¿é—®ï¼ˆç§æœ‰ bucketï¼‰         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ•°æ®å­˜å‚¨

- **åç«¯**: å†…å­˜å­˜å‚¨ï¼ˆ`tasks_storage` å’Œ `analysis_storage` å­—å…¸ï¼‰
- **å‰ç«¯**: æœ¬åœ°çŠ¶æ€ç®¡ç†ï¼ˆ`@Published` å±æ€§ + UserDefaultsï¼‰
- **å›¾ç‰‡å­˜å‚¨**: é˜¿é‡Œäº‘ OSSï¼ˆ`images/{session_id}/{image_index}.png`ï¼‰
- **æ—¥å¿—**: `~/gemini-audio-service.log`
- **æœªæ¥è®¡åˆ’**: PostgreSQL + Redis

---

## 2. æŠ€æœ¯æ ˆé€‰å‹

### 2.1 åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Python | 3.12 | è¿è¡Œç¯å¢ƒ |
| FastAPI | 0.128.0 | Web æ¡†æ¶ï¼Œå¼‚æ­¥æ”¯æŒ |
| Uvicorn | 0.40.0 | ASGI æœåŠ¡å™¨ |
| google-generativeai | 0.8.6 | Gemini API SDK (æ–‡æœ¬åˆ†æ) |
| google-genai | 0.2.0+ | Gemini API SDK (å›¾ç‰‡ç”Ÿæˆ) |
| oss2 | 2.18.0+ | é˜¿é‡Œäº‘ OSS SDK |
| Pydantic | 2.12.5 | æ•°æ®éªŒè¯å’Œåºåˆ—åŒ– |
| python-dotenv | 1.2.1 | ç¯å¢ƒå˜é‡ç®¡ç† |
| python-multipart | 0.0.21 | æ–‡ä»¶ä¸Šä¼ æ”¯æŒ |
| aiofiles | 25.1.0 | å¼‚æ­¥æ–‡ä»¶æ“ä½œ |

### 2.2 å‰ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Swift | 5.9+ | ç¼–ç¨‹è¯­è¨€ |
| SwiftUI | - | UI æ¡†æ¶ |
| iOS | 16.0+ | æœ€ä½æ”¯æŒç‰ˆæœ¬ |
| Alamofire | 5.8.0+ | ç½‘ç»œè¯·æ±‚åº“ |
| AVFoundation | - | éŸ³é¢‘å½•åˆ¶æ¡†æ¶ |
| Combine | - | å“åº”å¼ç¼–ç¨‹æ¡†æ¶ |

### 2.3 åŸºç¡€è®¾æ–½

| ç»„ä»¶ | é…ç½® | ç”¨é€” |
|------|------|------|
| æœåŠ¡å™¨ | é˜¿é‡Œäº‘æ–°åŠ å¡ | åç«¯æœåŠ¡éƒ¨ç½² |
| Nginx | - | åå‘ä»£ç†ï¼Œè½¬å‘ Gemini API |
| è™šæ‹Ÿç¯å¢ƒ | Python venv | ä¾èµ–éš”ç¦» |
| é˜¿é‡Œäº‘ OSS | oss-cn-beijing | å›¾ç‰‡å­˜å‚¨æœåŠ¡ |

---

## 3. æŠ€æœ¯é“¾è·¯æµç¨‹

### 3.1 éŸ³é¢‘ä¸Šä¼ ä¸åˆ†ææµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOS å®¢æˆ·ç«¯  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. ç”¨æˆ·ç‚¹å‡»å½•éŸ³
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AudioRecorderService â”‚
â”‚ - å¼€å§‹å½•éŸ³          â”‚
â”‚ - ä¿å­˜ä¸º M4A æ ¼å¼   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 2. åœæ­¢å½•éŸ³ï¼Œè·å–æ–‡ä»¶è·¯å¾„
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RecordingViewModel  â”‚
â”‚ - åœæ­¢å½•éŸ³          â”‚
â”‚ - å‡†å¤‡ä¸Šä¼           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 3. è°ƒç”¨ä¸Šä¼ æ¥å£
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NetworkManager      â”‚
â”‚ - æ„å»º multipart    â”‚
â”‚ - ä¸Šä¼ åˆ°æœåŠ¡å™¨      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 4. HTTP POST /api/v1/audio/upload
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI åç«¯æœåŠ¡                â”‚
â”‚ - æ¥æ”¶æ–‡ä»¶                      â”‚
â”‚ - ç”Ÿæˆ session_id              â”‚
â”‚ - ä¿å­˜ä»»åŠ¡æ•°æ®                 â”‚
â”‚ - è¿”å›å“åº”ï¼ˆç«‹å³è¿”å›ï¼‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 5. å¼‚æ­¥å¯åŠ¨åˆ†æä»»åŠ¡
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ analyze_audio_async (åå°ä»»åŠ¡)  â”‚
â”‚ - ä¸Šä¼ æ–‡ä»¶åˆ° Gemini             â”‚
â”‚ - ç­‰å¾…æ–‡ä»¶å¤„ç†å®Œæˆ              â”‚
â”‚ - è°ƒç”¨ Gemini æ¨¡å‹åˆ†æ          â”‚
â”‚ - è§£æå“åº”                      â”‚
â”‚ - æ›´æ–°ä»»åŠ¡çŠ¶æ€                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 6. HTTP è¯·æ±‚ï¼ˆé€šè¿‡ Nginx ä»£ç†ï¼‰
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Nginx åå‘ä»£ç†                  â”‚
â”‚ - æ¥æ”¶è¯·æ±‚                      â”‚
â”‚ - è½¬å‘åˆ° Google Gemini API      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 7. HTTPS è¯·æ±‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Google Gemini 3 Flash API       â”‚
â”‚ - å¤„ç†éŸ³é¢‘æ–‡ä»¶                  â”‚
â”‚ - ç”Ÿæˆåˆ†æç»“æœ                  â”‚
â”‚ - è¿”å› JSON æ•°æ®               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 8. è¿”å›åˆ†æç»“æœ
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI åç«¯æœåŠ¡                â”‚
â”‚ - è§£æ Gemini å“åº”              â”‚
â”‚ - å­˜å‚¨åˆ†æç»“æœ                  â”‚
â”‚ - æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸º archived       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ä»»åŠ¡åˆ—è¡¨æŸ¥è¯¢æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOS å®¢æˆ·ç«¯  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. æ‰“å¼€ä»»åŠ¡åˆ—è¡¨é¡µé¢
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TaskListViewModel   â”‚
â”‚ - åŠ è½½ä»»åŠ¡åˆ—è¡¨      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 2. è°ƒç”¨è·å–åˆ—è¡¨æ¥å£
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NetworkManager      â”‚
â”‚ - GET /tasks/sessionsâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 3. HTTP GET è¯·æ±‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI åç«¯æœåŠ¡                â”‚
â”‚ - æŸ¥è¯¢ tasks_storage            â”‚
â”‚ - åˆ†é¡µã€è¿‡æ»¤ã€æ’åº              â”‚
â”‚ - è¿”å›ä»»åŠ¡åˆ—è¡¨                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 ä»»åŠ¡è¯¦æƒ…æŸ¥è¯¢æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOS å®¢æˆ·ç«¯  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. ç‚¹å‡»ä»»åŠ¡å¡ç‰‡
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TaskDetailView      â”‚
â”‚ - åŠ è½½ä»»åŠ¡è¯¦æƒ…      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 2. è°ƒç”¨è·å–è¯¦æƒ…æ¥å£
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NetworkManager      â”‚
â”‚ - GET /tasks/sessions/{id}â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 3. HTTP GET è¯·æ±‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI åç«¯æœåŠ¡                â”‚
â”‚ - æŸ¥è¯¢ tasks_storage           â”‚
â”‚ - æŸ¥è¯¢ analysis_storage        â”‚
â”‚ - åˆå¹¶æ•°æ®è¿”å›                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. åŠŸèƒ½æè¿°

### 4.1 æ ¸å¿ƒåŠŸèƒ½

#### 4.1.1 éŸ³é¢‘å½•åˆ¶
- **åŠŸèƒ½**: åœ¨ iOS è®¾å¤‡ä¸Šå½•åˆ¶éŸ³é¢‘
- **æ ¼å¼**: M4A
- **å®ç°**: `AudioRecorderService` ä½¿ç”¨ AVFoundation
- **ç‰¹æ€§**:
  - å®æ—¶æ˜¾ç¤ºå½•åˆ¶æ—¶é•¿
  - æ”¯æŒæš‚åœ/ç»§ç»­ï¼ˆæœªæ¥åŠŸèƒ½ï¼‰
  - è‡ªåŠ¨ä¿å­˜åˆ° Documents ç›®å½•

#### 4.1.2 éŸ³é¢‘ä¸Šä¼ 
- **åŠŸèƒ½**: ä¸Šä¼ å½•åˆ¶çš„éŸ³é¢‘æ–‡ä»¶åˆ°æœåŠ¡å™¨
- **å®ç°**: `NetworkManager.uploadAudio()` ä½¿ç”¨ Alamofire multipart
- **ç‰¹æ€§**:
  - æ˜¾ç¤ºä¸Šä¼ è¿›åº¦
  - é”™è¯¯å¤„ç†å’Œé‡è¯•
  - è¯¦ç»†æ—¥å¿—è®°å½•

#### 4.1.3 éŸ³é¢‘åˆ†æ
- **åŠŸèƒ½**: ä½¿ç”¨ Gemini 3 Flash æ¨¡å‹åˆ†æéŸ³é¢‘
- **å®ç°**: å¼‚æ­¥åå°ä»»åŠ¡ `analyze_audio_async()`
- **åˆ†æå†…å®¹**:
  - è¯´è¯äººè¯†åˆ«å’Œæ•°é‡ç»Ÿè®¡
  - å¯¹è¯è½¬å½•ï¼ˆæŒ‰æ—¶é—´é¡ºåºï¼‰
  - æƒ…ç»ªåˆ†æ•°ï¼ˆ0-100ï¼‰
  - é£é™©ç‚¹è¯†åˆ«
  - å¯¹è¯æ€»ç»“
  - ç»Ÿè®¡ä¿¡æ¯ï¼ˆå¹æ°”æ¬¡æ•°ã€ç¬‘å£°æ¬¡æ•°ï¼‰

#### 4.1.4 ä»»åŠ¡ç®¡ç†
- **åŠŸèƒ½**: ç®¡ç†å½•éŸ³å’Œåˆ†æä»»åŠ¡
- **å®ç°**: å†…å­˜å­˜å‚¨ + RESTful API
- **ç‰¹æ€§**:
  - ä»»åŠ¡åˆ—è¡¨ï¼ˆåˆ†é¡µã€è¿‡æ»¤ã€æ’åºï¼‰
  - ä»»åŠ¡è¯¦æƒ…ï¼ˆåŒ…å«å®Œæ•´åˆ†æç»“æœï¼‰
  - ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢
  - è‡ªåŠ¨åˆ·æ–°

#### 4.1.5 ç­–ç•¥åˆ†æï¼ˆCall #2ï¼‰
- **åŠŸèƒ½**: åŸºäºå¯¹è¯è½¬å½•ç”Ÿæˆåº”å¯¹ç­–ç•¥
- **å®ç°**: `POST /api/v1/tasks/sessions/{id}/strategies`
- **è¾“å‡º**:
  - è§†è§‰åŒ–æ•°æ®ï¼ˆç«æŸ´äººæè¿°ã€å†…å¿ƒOSï¼‰
  - 3 ç§åº”å¯¹ç­–ç•¥ï¼ˆè‡ªä¸»ç ”åˆ¤ï¼‰
  - Markdown æ ¼å¼çš„è¯¦ç»†å»ºè®®

### 4.2 è¾…åŠ©åŠŸèƒ½

#### 4.2.1 å¥åº·æ£€æŸ¥
- **ç«¯ç‚¹**: `GET /health`
- **ç”¨é€”**: æœåŠ¡çŠ¶æ€ç›‘æ§

#### 4.2.2 æ—¥å¿—ç³»ç»Ÿ
- **åç«¯**: Python loggingï¼Œè¾“å‡ºåˆ° `~/gemini-audio-service.log`
- **å‰ç«¯**: print è¯­å¥ï¼Œè¾“å‡ºåˆ° Xcode æ§åˆ¶å°
- **çº§åˆ«**: DEBUGï¼ˆå¼€å‘ç¯å¢ƒï¼‰

---

## 5. API æ¥å£æ–‡æ¡£

### 5.1 é€šç”¨å“åº”æ ¼å¼

æ‰€æœ‰ API æ¥å£ä½¿ç”¨ç»Ÿä¸€çš„å“åº”æ ¼å¼ï¼š

```json
{
  "code": 200,
  "message": "success",
  "data": { ... },
  "timestamp": "2026-01-14T11:31:47.923Z"
}
```

**å­—æ®µè¯´æ˜**:
- `code`: çŠ¶æ€ç ï¼Œ200 è¡¨ç¤ºæˆåŠŸ
- `message`: å“åº”æ¶ˆæ¯
- `data`: å“åº”æ•°æ®ï¼ˆç±»å‹æ ¹æ®æ¥å£ä¸åŒï¼‰
- `timestamp`: ISO 8601 æ ¼å¼çš„æ—¶é—´æˆ³

### 5.2 ä¸Šä¼ éŸ³é¢‘

**æ¥å£**: `POST /api/v1/audio/upload`

**æè¿°**: ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶å¹¶å¼€å§‹å¼‚æ­¥åˆ†æ

**è¯·æ±‚**:
- **Content-Type**: `multipart/form-data`
- **å‚æ•°**:
  - `file` (File, required): éŸ³é¢‘æ–‡ä»¶ï¼ˆM4A/MP3/WAVï¼‰
  - `title` (String, optional): ä»»åŠ¡æ ‡é¢˜

**å“åº”**:
```json
{
  "code": 200,
  "message": "ä¸Šä¼ æˆåŠŸ",
  "data": {
    "session_id": "a09fa49b-269a-46ce-93ab-4b81edb01fb1",
    "audio_id": "a09fa49b-269a-46ce-93ab-4b81edb01fb1",
    "title": "å½•éŸ³ 11:31",
    "status": "analyzing",
    "estimated_duration": 300,
    "created_at": "2026-01-14T11:31:47.923Z"
  },
  "timestamp": "2026-01-14T11:31:47.923Z"
}
```

**çŠ¶æ€ç **:
- `200`: ä¸Šä¼ æˆåŠŸï¼Œåˆ†æä»»åŠ¡å·²å¯åŠ¨
- `500`: æœåŠ¡å™¨é”™è¯¯

**æ³¨æ„äº‹é¡¹**:
- ä¸Šä¼ åç«‹å³è¿”å›ï¼Œåˆ†æåœ¨åå°å¼‚æ­¥è¿›è¡Œ
- åˆ†æå®Œæˆåï¼Œä»»åŠ¡çŠ¶æ€è‡ªåŠ¨æ›´æ–°ä¸º `archived`
- å¯é€šè¿‡çŠ¶æ€æŸ¥è¯¢æ¥å£æ£€æŸ¥åˆ†æè¿›åº¦

### 5.3 è·å–ä»»åŠ¡åˆ—è¡¨

**æ¥å£**: `GET /api/v1/tasks/sessions`

**æè¿°**: è·å–ä»»åŠ¡åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œè¿‡æ»¤

**è¯·æ±‚å‚æ•°**:
- `page` (Integer, optional, default=1): é¡µç 
- `page_size` (Integer, optional, default=20): æ¯é¡µæ•°é‡ï¼ˆ1-100ï¼‰
- `date` (String, optional): æ—¥æœŸè¿‡æ»¤ï¼ˆæ ¼å¼: YYYY-MM-DDï¼‰
- `status` (String, optional): çŠ¶æ€è¿‡æ»¤ï¼ˆanalyzing/archived/failedï¼‰

**å“åº”**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "sessions": [
      {
        "session_id": "a09fa49b-269a-46ce-93ab-4b81edb01fb1",
        "title": "å½•éŸ³ 11:31",
        "start_time": "2026-01-14T11:31:47.923Z",
        "end_time": "2026-01-14T11:36:28.993Z",
        "duration": 281,
        "tags": ["#æ­£å¸¸"],
        "status": "archived",
        "emotion_score": 65,
        "speaker_count": 2
      }
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 1,
      "total_pages": 1
    }
  },
  "timestamp": "2026-01-14T11:40:00.000Z"
}
```

### 5.4 è·å–ä»»åŠ¡è¯¦æƒ…

**æ¥å£**: `GET /api/v1/tasks/sessions/{session_id}`

**æè¿°**: è·å–ä»»åŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆ†æç»“æœ

**è·¯å¾„å‚æ•°**:
- `session_id` (String, required): ä»»åŠ¡ ID

**å“åº”**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "session_id": "a09fa49b-269a-46ce-93ab-4b81edb01fb1",
    "title": "å½•éŸ³ 11:31",
    "start_time": "2026-01-14T11:31:47.923Z",
    "end_time": "2026-01-14T11:36:28.993Z",
    "duration": 281,
    "tags": ["#æ­£å¸¸"],
    "status": "archived",
    "emotion_score": 65,
    "speaker_count": 2,
    "dialogues": [
      {
        "speaker": "Speaker_0",
        "content": "å·²ç»ä¸¤ç‚¹åŠäº†ã€‚",
        "tone": "æœªçŸ¥",
        "timestamp": "00:00",
        "is_me": false
      },
      {
        "speaker": "Speaker_1",
        "content": "å™¢ï¼Œå¥½å§ã€‚ä½ è¿™æ¬¡å’‹æ ·ï¼Ÿçœ‹çœ‹ã€‚",
        "tone": "æœªçŸ¥",
        "timestamp": "00:01",
        "is_me": true
      }
    ],
    "risks": [],
    "summary": "å¯¹è¯å‘ç”Ÿåœ¨å‡Œæ™¨ä¸¤ç‚¹åŠ...",
    "created_at": "2026-01-14T11:31:47.923Z",
    "updated_at": "2026-01-14T11:36:28.993Z"
  },
  "timestamp": "2026-01-14T11:40:00.000Z"
}
```

**çŠ¶æ€ç **:
- `200`: æˆåŠŸ
- `404`: ä»»åŠ¡ä¸å­˜åœ¨
- `500`: æœåŠ¡å™¨é”™è¯¯

### 5.5 æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

**æ¥å£**: `GET /api/v1/tasks/sessions/{session_id}/status`

**æè¿°**: æŸ¥è¯¢ä»»åŠ¡çš„åˆ†æçŠ¶æ€å’Œè¿›åº¦

**è·¯å¾„å‚æ•°**:
- `session_id` (String, required): ä»»åŠ¡ ID

**å“åº”**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "session_id": "a09fa49b-269a-46ce-93ab-4b81edb01fb1",
    "status": "archived",
    "progress": 1.0,
    "estimated_time_remaining": 0,
    "updated_at": "2026-01-14T11:36:28.993Z"
  },
  "timestamp": "2026-01-14T11:40:00.000Z"
}
```

**çŠ¶æ€å€¼**:
- `analyzing`: åˆ†æä¸­
- `archived`: å·²å®Œæˆ
- `failed`: åˆ†æå¤±è´¥

### 5.6 ç”Ÿæˆç­–ç•¥åˆ†æ

**æ¥å£**: `POST /api/v1/tasks/sessions/{session_id}/strategies`

**æè¿°**: åŸºäºå¯¹è¯è½¬å½•ç”Ÿæˆåº”å¯¹ç­–ç•¥ï¼ˆCall #2ï¼‰

**è·¯å¾„å‚æ•°**:
- `session_id` (String, required): ä»»åŠ¡ ID

**å“åº”**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "visual": [
      {
        "transcript_index": 0,
        "speaker": "Speaker_0",
        "image_prompt": "ç±³è‰²èƒŒæ™¯ï¼Œæç®€ç«æŸ´äººçº¿ç¨¿...",
        "emotion": "å¼ºå‹ã€æ”¯é…",
        "subtext": "é€šè¿‡èº«ä½“ä¾µç•¥æ€§ç©ºé—´æ¥æ–½åŠ å¿ƒç†å‹åŠ›",
        "context": "æ­£å¸¸çš„è¿›åº¦æ±‡æŠ¥çªç„¶è¢«ä¸åˆç†çš„æ–°éœ€æ±‚æ‰“æ–­",
        "my_inner": "æ„Ÿåˆ°è¢«å†’çŠ¯ä½†ä¿æŒç¤¼è²Œ",
        "other_inner": "è¯•æ¢å¯¹æ–¹çš„å¼¹æ€§",
        "image_url": "https://geminipicture2.oss-cn-beijing.aliyuncs.com/images/670a5864-22d2-4978-b996-bce22c61afc5/0.png",
        "image_base64": null
      }
    ],
    "strategies": [
      {
        "id": "s1",
        "label": "å€ŸåŠ›æ‰“åŠ›",
        "emoji": "âš”ï¸",
        "title": "ç­–ç•¥æ ‡é¢˜",
        "content": "### å»ºè®®è¯æœ¯\n1. **å¿ƒç†é€»è¾‘**: ...\n2. **æ¨èè¯æœ¯**: '...'"
      }
    ]
  },
  "timestamp": "2026-01-14T11:40:00.000Z"
}
```

**è¯´æ˜**:
- `visual` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¤šä¸ªå…³é”®æ—¶åˆ»çš„è§†è§‰æ•°æ®
- æ¯ä¸ªå…³é”®æ—¶åˆ»åŒ…å«ï¼š
  - `image_url`: å›¾ç‰‡ URLï¼ˆä¼˜å…ˆä½¿ç”¨ï¼ŒOSS å­˜å‚¨ï¼‰
  - `image_base64`: Base64 ç¼–ç çš„å›¾ç‰‡ï¼ˆå¤‡ç”¨ï¼ŒOSS å¤±è´¥æ—¶ä½¿ç”¨ï¼‰
  - `image_prompt`: å›¾ç‰‡ç”Ÿæˆæç¤ºè¯
  - å…¶ä»–æƒ…ç»ªã€æ½œå°è¯ç­‰ä¿¡æ¯
- å›¾ç‰‡ç”Ÿæˆä½¿ç”¨ Gemini Nano Banana æ¨¡å‹ï¼Œè‡ªåŠ¨ä¸Šä¼ åˆ° OSS
- å¦‚æœ OSS ä¸Šä¼ å¤±è´¥ï¼Œä¼šé™çº§ä¸º Base64 è¿”å›

**å‰ç½®æ¡ä»¶**:
- ä»»åŠ¡å¿…é¡»å·²å®Œæˆåˆ†æï¼ˆstatus = archivedï¼‰
- å¿…é¡»æœ‰å¯¹è¯è½¬å½•æ•°æ®

### 5.7 è·å–å›¾ç‰‡

**æ¥å£**: `GET /api/v1/images/{session_id}/{image_index}`

**æè¿°**: ä» OSS è·å–å›¾ç‰‡ï¼ˆæ”¯æŒç§æœ‰ bucket è®¿é—®ï¼‰

**è·¯å¾„å‚æ•°**:
- `session_id` (String, required): ä¼šè¯ ID
- `image_index` (Integer, required): å›¾ç‰‡ç´¢å¼•ï¼ˆ0, 1, 2...ï¼‰

**å“åº”**:
- æˆåŠŸ: è¿”å› PNG å›¾ç‰‡æ•°æ®ï¼ŒContent-Type: `image/png`
- å¤±è´¥: JSON é”™è¯¯ä¿¡æ¯

**å“åº”å¤´**:
```
Content-Type: image/png
Cache-Control: public, max-age=3600
Content-Disposition: inline; filename="image_{image_index}.png"
```

**é”™è¯¯å“åº”**:
```json
{
  "detail": "Image not found"
}
```

**è¯´æ˜**:
- ç”±äº OSS bucket è®¾ç½®ä¸ºç§æœ‰ï¼Œä¸èƒ½ç›´æ¥è®¿é—® OSS URL
- å¿…é¡»é€šè¿‡æ­¤ API æ¥å£è®¿é—®å›¾ç‰‡
- åç«¯ä¼šä» OSS è·å–å›¾ç‰‡å¹¶è¿”å›
- æ”¯æŒç¼“å­˜ï¼ˆ1 å°æ—¶ï¼‰

**ç¤ºä¾‹**:
```
GET http://47.79.254.213:8001/api/v1/images/670a5864-22d2-4978-b996-bce22c61afc5/0
```

### 5.8 å¥åº·æ£€æŸ¥

**æ¥å£**: `GET /health`

**æè¿°**: æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ

**å“åº”**:
```json
{
  "message": "éŸ³é¢‘åˆ†ææœåŠ¡æ­£åœ¨è¿è¡Œ",
  "status": "ok"
}
```

---

## 6. æ•°æ®æ¨¡å‹

### 6.1 åç«¯æ•°æ®æ¨¡å‹ï¼ˆPydanticï¼‰

#### 6.1.1 APIResponse
```python
class APIResponse(BaseModel):
    code: int
    message: str
    data: Optional[dict] = None
    timestamp: Optional[str] = None
```

#### 6.1.2 UploadResponse
```python
class UploadResponse(BaseModel):
    session_id: str
    audio_id: str
    title: str
    status: str
    estimated_duration: Optional[int] = None
    created_at: str
```

#### 6.1.3 TaskItem
```python
class TaskItem(BaseModel):
    session_id: str
    title: str
    start_time: str
    end_time: Optional[str] = None
    duration: int
    tags: List[str] = []
    status: str
    emotion_score: Optional[int] = None
    speaker_count: Optional[int] = None
```

#### 6.1.4 TaskDetailResponse
```python
class TaskDetailResponse(BaseModel):
    session_id: str
    title: str
    start_time: str
    end_time: Optional[str] = None
    duration: int
    tags: List[str] = []
    status: str
    emotion_score: Optional[int] = None
    speaker_count: Optional[int] = None
    dialogues: List[dict] = []
    risks: List[str] = []
    summary: Optional[str] = None
    created_at: str
    updated_at: str
```

#### 6.1.5 Call1Response
```python
class Call1Response(BaseModel):
    mood_score: int  # 0-100
    stats: dict  # {"sigh": int, "laugh": int}
    summary: str
    transcript: List[TranscriptItem]
```

#### 6.1.6 VisualData
```python
class VisualData(BaseModel):
    """è§†è§‰æ•°æ®æ¨¡å‹ï¼ˆå…³é”®æ—¶åˆ»ï¼‰"""
    transcript_index: int  # å…³è”çš„ transcript ç´¢å¼•
    speaker: str  # è¯´è¯äººæ ‡è¯†
    image_prompt: str  # ç«æŸ´äººå›¾ç‰‡æè¿°è¯ï¼ˆè¯¦ç»†ç‰ˆï¼‰
    emotion: str  # è¯´è¯äººæƒ…ç»ª
    subtext: str  # æ½œå°è¯
    context: str  # å½“æ—¶çš„æƒ…æ™¯æˆ–å¿ƒç†çŠ¶æ€
    my_inner: str  # æˆ‘çš„å†…å¿ƒOS
    other_inner: str  # å¯¹æ–¹çš„å†…å¿ƒOS
    image_url: Optional[str] = None  # å›¾ç‰‡ URLï¼ˆä¼˜å…ˆä½¿ç”¨ï¼ŒOSS å­˜å‚¨ï¼‰
    image_base64: Optional[str] = None  # Base64 ç¼–ç çš„å›¾ç‰‡æ•°æ®ï¼ˆå¤‡ç”¨ï¼‰
```

#### 6.1.7 StrategyItem
```python
class StrategyItem(BaseModel):
    id: str  # ç­–ç•¥ID
    label: str  # ç­–ç•¥æ ‡ç­¾
    emoji: str  # è¡¨æƒ…ç¬¦å·
    title: str  # ç­–ç•¥æ ‡é¢˜
    content: str  # ç­–ç•¥å†…å®¹ï¼ˆMarkdownæ ¼å¼ï¼‰
```

#### 6.1.8 Call2Response
```python
class Call2Response(BaseModel):
    """ç­–ç•¥åˆ†æå“åº”"""
    visual: List[VisualData]  # è§†è§‰æ•°æ®æ•°ç»„ï¼ˆå¤šä¸ªå…³é”®æ—¶åˆ»ï¼‰
    strategies: List[StrategyItem]  # ç­–ç•¥åˆ—è¡¨
```

### 6.2 å‰ç«¯æ•°æ®æ¨¡å‹ï¼ˆSwiftï¼‰

#### 6.2.1 Task
```swift
struct Task: Codable, Identifiable {
    let id: String  // session_id
    let title: String
    let startTime: Date
    let endTime: Date?
    let duration: Int
    let tags: [String]
    let status: TaskStatus
    let emotionScore: Int?
    let speakerCount: Int?
}
```

#### 6.2.2 APIResponse
```swift
struct APIResponse<T: Codable>: Codable {
    let code: Int
    let message: String
    let data: T?
    let timestamp: String?
}
```

#### 6.2.3 UploadResponse
```swift
struct UploadResponse: Codable {
    let sessionId: String
    let audioId: String
    let title: String
    let status: String
    let estimatedDuration: Int?
    let createdAt: String?
}
```

#### 6.2.4 VisualData
```swift
struct VisualData: Codable, Identifiable {
    var id: String { "\(transcriptIndex)" }
    let transcriptIndex: Int
    let speaker: String
    let imagePrompt: String
    let emotion: String
    let subtext: String
    let context: String
    let myInner: String
    let otherInner: String
    let imageUrl: String?
    let imageBase64: String?
    
    // å°† OSS URL è½¬æ¢ä¸ºåç«¯ API URL
    func getAccessibleImageURL(baseURL: String) -> String?
}
```

#### 6.2.5 StrategyAnalysisResponse
```swift
struct StrategyAnalysisResponse: Codable {
    let visual: [VisualData]  // å…³é”®æ—¶åˆ»æ•°ç»„
    let strategies: [StrategyItem]  // ç­–ç•¥åˆ—è¡¨
}

struct StrategyItem: Codable, Identifiable {
    let id: String  // ä½¿ç”¨ title ä½œä¸º id
    let title: String
    let content: String
}
```

---

## 7. äº¤äº’é“¾è·¯

### 7.1 éŸ³é¢‘ä¸Šä¼ å®Œæ•´äº¤äº’é“¾è·¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOS å®¢æˆ·ç«¯                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ç”¨æˆ·æ“ä½œ: ç‚¹å‡»å½•éŸ³æŒ‰é’®                                    â”‚
â”‚    â†’ RecordingViewModel.startRecording()                    â”‚
â”‚    â†’ AudioRecorderService.startRecording()                 â”‚
â”‚                                                             â”‚
â”‚ 2. ç”¨æˆ·æ“ä½œ: åœæ­¢å½•éŸ³                                        â”‚
â”‚    â†’ RecordingViewModel.stopRecordingAndUpload()           â”‚
â”‚    â†’ AudioRecorderService.stopRecording()                 â”‚
â”‚    â†’ è¿”å›æ–‡ä»¶è·¯å¾„: /Documents/recording_xxx.m4a            â”‚
â”‚                                                             â”‚
â”‚ 3. å‡†å¤‡ä¸Šä¼                                                  â”‚
â”‚    â†’ RecordingViewModel.isUploading = true                 â”‚
â”‚    â†’ NetworkManager.uploadAudio(fileURL:)                  â”‚
â”‚                                                             â”‚
â”‚ 4. æ„å»ºè¯·æ±‚                                                 â”‚
â”‚    â†’ Alamofire multipart form data                        â”‚
â”‚    â†’ æ·»åŠ æ–‡ä»¶: file (audio/m4a)                            â”‚
â”‚    â†’ POST http://47.79.254.213:8001/api/v1/audio/upload   â”‚
â”‚                                                             â”‚
â”‚ 5. ä¸Šä¼ è¿›åº¦ç›‘å¬                                             â”‚
â”‚    â†’ uploadProgress callback                               â”‚
â”‚    â†’ æ˜¾ç¤ºè¿›åº¦: 0% â†’ 100%                                   â”‚
â”‚                                                             â”‚
â”‚ 6. æ¥æ”¶å“åº”                                                 â”‚
â”‚    â†’ è§£æ JSON                                              â”‚
â”‚    â†’ APIResponse<UploadResponse>                          â”‚
â”‚    â†’ æå– data.sessionId                                   â”‚
â”‚                                                             â”‚
â”‚ 7. å¤„ç†ç»“æœ                                                 â”‚
â”‚    â†’ RecordingViewModel.isUploading = false               â”‚
â”‚    â†’ å‘é€é€šçŸ¥: TaskUploaded                                â”‚
â”‚    â†’ TaskListViewModel åˆ·æ–°åˆ—è¡¨                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP POST
                            â”‚ multipart/form-data
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI åç«¯æœåŠ¡                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æ¥æ”¶è¯·æ±‚                                                â”‚
â”‚    â†’ POST /api/v1/audio/upload                            â”‚
â”‚    â†’ è§£æ multipart form data                              â”‚
â”‚    â†’ æå– file å’Œ title                                    â”‚
â”‚                                                             â”‚
â”‚ 2. å¤„ç†æ–‡ä»¶                                                â”‚
â”‚    â†’ è¯»å–æ–‡ä»¶å†…å®¹                                          â”‚
â”‚    â†’ ä¿å­˜åˆ°ä¸´æ—¶æ–‡ä»¶                                        â”‚
â”‚    â†’ è®°å½•æ–‡ä»¶å¤§å°                                          â”‚
â”‚                                                             â”‚
â”‚ 3. åˆ›å»ºä»»åŠ¡                                                â”‚
â”‚    â†’ ç”Ÿæˆ UUID (session_id)                               â”‚
â”‚    â†’ åˆ›å»ºä»»åŠ¡æ•°æ®                                          â”‚
â”‚    â†’ å­˜å‚¨åˆ° tasks_storage                                  â”‚
â”‚    â†’ çŠ¶æ€: analyzing                                       â”‚
â”‚                                                             â”‚
â”‚ 4. å¯åŠ¨å¼‚æ­¥åˆ†æ                                            â”‚
â”‚    â†’ asyncio.create_task(analyze_audio_async(...))        â”‚
â”‚    â†’ ä¼ é€’: session_id, file_path, filename, task_data     â”‚
â”‚                                                             â”‚
â”‚ 5. ç«‹å³è¿”å›å“åº”                                            â”‚
â”‚    â†’ æ„å»º APIResponse                                      â”‚
â”‚    â†’ è¿”å› JSONResponse                                     â”‚
â”‚    â†’ çŠ¶æ€ç : 200                                           â”‚
â”‚                                                             â”‚
â”‚ 6. åå°åˆ†æï¼ˆå¼‚æ­¥ï¼‰                                        â”‚
â”‚    â†’ analyze_audio_async()                                 â”‚
â”‚    â†’ ä¸Šä¼ åˆ° Gemini                                         â”‚
â”‚    â†’ ç­‰å¾…æ–‡ä»¶å¤„ç†                                          â”‚
â”‚    â†’ è°ƒç”¨æ¨¡å‹åˆ†æ                                          â”‚
â”‚    â†’ è§£æç»“æœ                                              â”‚
â”‚    â†’ æ›´æ–°ä»»åŠ¡çŠ¶æ€: archived                                â”‚
â”‚    â†’ å­˜å‚¨åˆ†æç»“æœ                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP (é€šè¿‡ Nginx ä»£ç†)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Google Gemini 3 Flash API                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æ¥æ”¶æ–‡ä»¶ä¸Šä¼                                             â”‚
â”‚    â†’ genai.upload_file()                                   â”‚
â”‚    â†’ æ–‡ä»¶çŠ¶æ€: PROCESSING â†’ ACTIVE                         â”‚
â”‚                                                             â”‚
â”‚ 2. è°ƒç”¨æ¨¡å‹åˆ†æ                                            â”‚
â”‚    â†’ model.generate_content([file, prompt])                â”‚
â”‚    â†’ æ¨¡å‹: gemini-3-flash-preview                          â”‚
â”‚                                                             â”‚
â”‚ 3. è¿”å›åˆ†æç»“æœ                                            â”‚
â”‚    â†’ JSON æ ¼å¼                                             â”‚
â”‚    â†’ åŒ…å«: mood_score, transcript, risks, summary          â”‚
â”‚                                                             â”‚
â”‚ 4. æ¸…ç†èµ„æº                                                â”‚
â”‚    â†’ genai.delete_file()                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 ä»»åŠ¡åˆ—è¡¨æŸ¥è¯¢äº¤äº’é“¾è·¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOS å®¢æˆ·ç«¯                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. é¡µé¢åŠ è½½                                                 â”‚
â”‚    â†’ TaskListViewModel.onAppear()                          â”‚
â”‚    â†’ loadTasks()                                            â”‚
â”‚                                                             â”‚
â”‚ 2. æ„å»ºè¯·æ±‚                                                 â”‚
â”‚    â†’ NetworkManager.getTaskList()                           â”‚
â”‚    â†’ GET /api/v1/tasks/sessions?page=1&page_size=20        â”‚
â”‚                                                             â”‚
â”‚ 3. æ¥æ”¶å“åº”                                                 â”‚
â”‚    â†’ APIResponse<TaskListResponse>                          â”‚
â”‚    â†’ è§£æ sessions æ•°ç»„                                    â”‚
â”‚    â†’ è½¬æ¢ä¸º Task æ¨¡å‹                                      â”‚
â”‚                                                             â”‚
â”‚ 4. æ›´æ–° UI                                                  â”‚
â”‚    â†’ TaskListViewModel.tasks = [...]                       â”‚
â”‚    â†’ SwiftUI è‡ªåŠ¨åˆ·æ–°                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP GET
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI åç«¯æœåŠ¡                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æ¥æ”¶è¯·æ±‚                                                â”‚
â”‚    â†’ GET /api/v1/tasks/sessions                            â”‚
â”‚    â†’ è§£ææŸ¥è¯¢å‚æ•°: page, page_size, date, status           â”‚
â”‚                                                             â”‚
â”‚ 2. æŸ¥è¯¢æ•°æ®                                                â”‚
â”‚    â†’ ä» tasks_storage è·å–æ‰€æœ‰ä»»åŠ¡                         â”‚
â”‚    â†’ åº”ç”¨è¿‡æ»¤æ¡ä»¶ï¼ˆæ—¥æœŸã€çŠ¶æ€ï¼‰                             â”‚
â”‚    â†’ æ’åºï¼ˆæŒ‰åˆ›å»ºæ—¶é—´å€’åºï¼‰                                 â”‚
â”‚                                                             â”‚
â”‚ 3. åˆ†é¡µå¤„ç†                                                â”‚
â”‚    â†’ è®¡ç®—åˆ†é¡µå‚æ•°                                           â”‚
â”‚    â†’ åˆ‡ç‰‡è·å–å½“å‰é¡µæ•°æ®                                     â”‚
â”‚                                                             â”‚
â”‚ 4. è¿”å›å“åº”                                                â”‚
â”‚    â†’ æ„å»º TaskItem åˆ—è¡¨                                    â”‚
â”‚    â†’ è¿”å› APIResponse                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 ä»»åŠ¡è¯¦æƒ…æŸ¥è¯¢äº¤äº’é“¾è·¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOS å®¢æˆ·ç«¯                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ç”¨æˆ·æ“ä½œ: ç‚¹å‡»ä»»åŠ¡å¡ç‰‡                                   â”‚
â”‚    â†’ NavigationLink to TaskDetailView                      â”‚
â”‚                                                             â”‚
â”‚ 2. åŠ è½½è¯¦æƒ…                                                 â”‚
â”‚    â†’ TaskDetailViewModel.loadTaskDetail()                  â”‚
â”‚    â†’ NetworkManager.getTaskDetail(sessionId:)               â”‚
â”‚    â†’ GET /api/v1/tasks/sessions/{session_id}               â”‚
â”‚                                                             â”‚
â”‚ 3. æ¥æ”¶å“åº”                                                 â”‚
â”‚    â†’ APIResponse<TaskDetailResponse>                        â”‚
â”‚    â†’ è§£æè¯¦æƒ…æ•°æ®                                           â”‚
â”‚    â†’ æ›´æ–° UI                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP GET
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FastAPI åç«¯æœåŠ¡                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æ¥æ”¶è¯·æ±‚                                                â”‚
â”‚    â†’ GET /api/v1/tasks/sessions/{session_id}               â”‚
â”‚    â†’ æå– session_id                                        â”‚
â”‚                                                             â”‚
â”‚ 2. æŸ¥è¯¢æ•°æ®                                                â”‚
â”‚    â†’ tasks_storage.get(session_id)                          â”‚
â”‚    â†’ analysis_storage.get(session_id)                      â”‚
â”‚                                                             â”‚
â”‚ 3. åˆå¹¶æ•°æ®                                                â”‚
â”‚    â†’ ä»»åŠ¡åŸºæœ¬ä¿¡æ¯ + åˆ†æç»“æœ                                â”‚
â”‚    â†’ æ„å»º TaskDetailResponse                                â”‚
â”‚                                                             â”‚
â”‚ 4. è¿”å›å“åº”                                                â”‚
â”‚    â†’ APIResponse                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. å‰ç«¯æŠ€æœ¯å®ç°

### 8.1 æ ¸å¿ƒç»„ä»¶

#### 8.1.1 AudioRecorderService
**èŒè´£**: éŸ³é¢‘å½•åˆ¶ç®¡ç†

**å…³é”®æ–¹æ³•**:
- `startRecording()`: å¼€å§‹å½•éŸ³
- `stopRecording()`: åœæ­¢å½•éŸ³ï¼Œè¿”å›æ–‡ä»¶è·¯å¾„
- `recordingTime`: å½“å‰å½•åˆ¶æ—¶é•¿

**å®ç°ç»†èŠ‚**:
- ä½¿ç”¨ `AVAudioRecorder`
- æ ¼å¼: M4A
- ä¿å­˜è·¯å¾„: `Documents/recording_{timestamp}.m4a`

#### 8.1.2 NetworkManager
**èŒè´£**: ç½‘ç»œè¯·æ±‚ç®¡ç†

**å…³é”®æ–¹æ³•**:
- `uploadAudio(fileURL:)`: ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶
- `getTaskList(...)`: è·å–ä»»åŠ¡åˆ—è¡¨
- `getTaskDetail(sessionId:)`: è·å–ä»»åŠ¡è¯¦æƒ…
- `getStrategyAnalysis(sessionId:)`: è·å–ç­–ç•¥åˆ†æï¼ˆåŒ…å«å›¾ç‰‡ï¼‰

**å®ç°ç»†èŠ‚**:
- ä½¿ç”¨ Alamofire
- BaseURL: `http://47.79.254.213:8001/api/v1`
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- æ”¯æŒå›¾ç‰‡ URL è‡ªåŠ¨è½¬æ¢ï¼ˆOSS URL â†’ åç«¯ API URLï¼‰

#### 8.1.3 RecordingViewModel
**èŒè´£**: å½•éŸ³ä¸šåŠ¡é€»è¾‘

**å…³é”®å±æ€§**:
- `@Published var isRecording: Bool`
- `@Published var recordingTime: TimeInterval`
- `@Published var isUploading: Bool`

**å…³é”®æ–¹æ³•**:
- `startRecording()`: å¼€å§‹å½•éŸ³
- `stopRecordingAndUpload()`: åœæ­¢å¹¶ä¸Šä¼ 

#### 8.1.4 TaskListViewModel
**èŒè´£**: ä»»åŠ¡åˆ—è¡¨ä¸šåŠ¡é€»è¾‘

**å…³é”®å±æ€§**:
- `@Published var tasks: [Task] = []`
- `@Published var isLoading: Bool = false`

**å…³é”®æ–¹æ³•**:
- `loadTasks()`: åŠ è½½ä»»åŠ¡åˆ—è¡¨
- `refreshTasks()`: åˆ·æ–°åˆ—è¡¨

### 8.2 UI ç»„ä»¶

#### 8.2.1 RecordingButtonView
**åŠŸèƒ½**: å½•éŸ³æŒ‰é’® UI

**ç‰¹æ€§**:
- æ˜¾ç¤ºå½•åˆ¶æ—¶é•¿
- å¼€å§‹/åœæ­¢å½•éŸ³
- ä¸Šä¼ çŠ¶æ€æŒ‡ç¤º

#### 8.2.2 TaskListView
**åŠŸèƒ½**: ä»»åŠ¡åˆ—è¡¨ UI

**ç‰¹æ€§**:
- æ˜¾ç¤ºä»»åŠ¡å¡ç‰‡
- ä¸‹æ‹‰åˆ·æ–°
- åˆ†é¡µåŠ è½½ï¼ˆæœªæ¥åŠŸèƒ½ï¼‰

#### 8.2.3 TaskCardView
**åŠŸèƒ½**: ä»»åŠ¡å¡ç‰‡ UI

**æ˜¾ç¤ºå†…å®¹**:
- ä»»åŠ¡æ ‡é¢˜
- æ—¶é—´èŒƒå›´
- æƒ…ç»ªåˆ†æ•°
- çŠ¶æ€æ ‡ç­¾

#### 8.2.4 TaskDetailView
**åŠŸèƒ½**: ä»»åŠ¡è¯¦æƒ… UI

**æ˜¾ç¤ºå†…å®¹**:
- ä»»åŠ¡åŸºæœ¬ä¿¡æ¯
- å¯¹è¯åˆ—è¡¨
- é£é™©ç‚¹
- åˆ†ææ€»ç»“

### 8.3 å›¾ç‰‡æ˜¾ç¤ºç»„ä»¶ï¼ˆæ–°å¢ï¼‰

#### 8.3.1 VisualData
**èŒè´£**: å…³é”®æ—¶åˆ»æ•°æ®æ¨¡å‹

**å…³é”®å±æ€§**:
- `transcriptIndex`: å…³è”çš„è½¬å½•ç´¢å¼•
- `speaker`: è¯´è¯äººæ ‡è¯†
- `emotion`: æƒ…ç»ªæè¿°
- `imageUrl`: å›¾ç‰‡ URLï¼ˆOSS æˆ–åç«¯ APIï¼‰
- `imageBase64`: Base64 ç¼–ç çš„å›¾ç‰‡ï¼ˆå¤‡ç”¨ï¼‰

**å…³é”®æ–¹æ³•**:
- `getAccessibleImageURL(baseURL:)`: å°† OSS URL è½¬æ¢ä¸ºåç«¯ API URL

#### 8.3.2 ImageLoaderView
**èŒè´£**: å›¾ç‰‡åŠ è½½ç»„ä»¶

**åŠŸèƒ½**:
- æ”¯æŒä» URL æˆ– Base64 åŠ è½½å›¾ç‰‡
- è‡ªåŠ¨å¤„ç†åŠ è½½çŠ¶æ€ï¼ˆåŠ è½½ä¸­ã€æˆåŠŸã€å¤±è´¥ï¼‰
- æ˜¾ç¤ºå ä½ç¬¦å’Œé”™è¯¯æç¤º

**ä½¿ç”¨ç¤ºä¾‹**:
```swift
ImageLoaderView(
    imageUrl: "http://47.79.254.213:8001/api/v1/images/\(sessionId)/0",
    imageBase64: nil,
    placeholder: "åŠ è½½ä¸­..."
)
```

#### 8.3.3 VisualMomentCarouselView
**èŒè´£**: å…³é”®æ—¶åˆ»å›¾ç‰‡è½®æ’­ç»„ä»¶

**åŠŸèƒ½**:
- æ”¯æŒå·¦å³æ»‘åŠ¨æŸ¥çœ‹å¤šå¼ å›¾ç‰‡
- æ˜¾ç¤ºé¡µç æŒ‡ç¤ºå™¨ï¼ˆç¬¬ X/æ€»æ•°ï¼‰
- è‡ªåŠ¨å¤„ç†ç©ºæ•°æ®æƒ…å†µ

**ä½¿ç”¨ç¤ºä¾‹**:
```swift
VisualMomentCarouselView(
    visualMoments: visualDataArray,
    baseURL: "http://47.79.254.213:8001/api/v1"
)
```

#### 8.3.4 StrategyAnalysisView_Updated
**èŒè´£**: ç­–ç•¥åˆ†æè§†å›¾ï¼ˆé›†æˆå›¾ç‰‡æ˜¾ç¤ºï¼‰

**åŠŸèƒ½**:
- æ˜¾ç¤ºå…³é”®æ—¶åˆ»å›¾ç‰‡è½®æ’­
- æ˜¾ç¤ºç­–ç•¥åˆ—è¡¨ï¼ˆå¯å±•å¼€/æ”¶èµ·ï¼‰
- å®Œæ•´çš„åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†

**ä½¿ç”¨ç¤ºä¾‹**:
```swift
StrategyAnalysisView_Updated(
    sessionId: sessionId,
    baseURL: "http://47.79.254.213:8001/api/v1"
)
```

---

## 9. åç«¯æŠ€æœ¯å®ç°

### 9.1 æ ¸å¿ƒæ¨¡å—

#### 9.1.1 FastAPI åº”ç”¨
```python
app = FastAPI(title="éŸ³é¢‘åˆ†ææœåŠ¡", description="é€šè¿‡ Gemini API åˆ†æéŸ³é¢‘æ–‡ä»¶")
```

**é…ç½®**:
- æ—¥å¿—çº§åˆ«: DEBUG
- æ—¥å¿—æ–‡ä»¶: `~/gemini-audio-service.log`
- ç¯å¢ƒå˜é‡: `.env` æ–‡ä»¶

#### 9.1.2 Gemini API é…ç½®
```python
genai.configure(api_key=GEMINI_API_KEY, transport='rest')
```

**ç‰¹æ€§**:
- åå‘ä»£ç†æ”¯æŒ
- è‡ªåŠ¨ URL é‡å†™
- é‡è¯•æœºåˆ¶

#### 9.1.3 å¼‚æ­¥åˆ†æä»»åŠ¡
```python
async def analyze_audio_async(session_id, temp_file_path, file_filename, task_data):
    # 1. ä¸Šä¼ æ–‡ä»¶åˆ° Gemini
    # 2. ç­‰å¾…æ–‡ä»¶å¤„ç†å®Œæˆ
    # 3. è°ƒç”¨æ¨¡å‹åˆ†æ
    # 4. è§£æç»“æœ
    # 5. æ›´æ–°ä»»åŠ¡çŠ¶æ€
```

**æµç¨‹**:
1. ä¸Šä¼ æ–‡ä»¶åˆ° Geminiï¼ˆå¸¦é‡è¯•ï¼‰
2. ç­‰å¾…æ–‡ä»¶çŠ¶æ€å˜ä¸º ACTIVEï¼ˆæœ€å¤š 10 åˆ†é’Ÿï¼‰
3. è°ƒç”¨ Gemini æ¨¡å‹åˆ†æï¼ˆå¸¦é‡è¯•ï¼‰
4. è§£æ JSON å“åº”
5. æ›´æ–°ä»»åŠ¡çŠ¶æ€å’Œåˆ†æç»“æœ

### 9.2 æ•°æ®å­˜å‚¨

#### 9.2.1 å†…å­˜å­˜å‚¨
```python
tasks_storage: dict = {}  # ä»»åŠ¡æ•°æ®
analysis_storage: dict = {}  # åˆ†æç»“æœ
```

**æ•°æ®ç»“æ„**:
- `tasks_storage[session_id]`: ä»»åŠ¡åŸºæœ¬ä¿¡æ¯
- `analysis_storage[session_id]`: åˆ†æç»“æœï¼ˆdialogues, risks, call1, call2ï¼‰

### 9.3 é”™è¯¯å¤„ç†

#### 9.3.1 å¼‚å¸¸æ•è·
- æ‰€æœ‰ API ç«¯ç‚¹éƒ½æœ‰ try-except
- è®°å½•è¯¦ç»†é”™è¯¯æ—¥å¿—
- è¿”å›å‹å¥½çš„é”™è¯¯æ¶ˆæ¯

#### 9.3.2 é‡è¯•æœºåˆ¶
- æ–‡ä»¶ä¸Šä¼ : æœ€å¤š 3 æ¬¡é‡è¯•
- æ¨¡å‹è°ƒç”¨: æœ€å¤š 3 æ¬¡é‡è¯•
- æ¯æ¬¡é‡è¯•é—´éš” 5 ç§’

---

## 10. éƒ¨ç½²é…ç½®

### 10.1 æœåŠ¡å™¨ç¯å¢ƒ

**æœåŠ¡å™¨ä¿¡æ¯**:
- IP: 47.79.254.213
- ä½ç½®: é˜¿é‡Œäº‘æ–°åŠ å¡
- æ“ä½œç³»ç»Ÿ: Linux

**æœåŠ¡é…ç½®**:
- Python 3.12
- è™šæ‹Ÿç¯å¢ƒ: `~/gemini-audio-service/venv`
- æœåŠ¡ç«¯å£: 8001
- æ—¥å¿—æ–‡ä»¶: `~/gemini-audio-service.log`

### 10.2 ç¯å¢ƒå˜é‡

**.env æ–‡ä»¶**:
```env
GEMINI_API_KEY=your_api_key_here
PROXY_URL=http://47.79.254.213/secret-channel
USE_PROXY=true
```

### 10.3 å¯åŠ¨æœåŠ¡

**å‘½ä»¤**:
```bash
cd ~/gemini-audio-service
source venv/bin/activate
nohup python3 main.py > ~/gemini-audio-service.log 2>&1 &
```

**éªŒè¯**:
```bash
curl http://localhost:8001/health
curl http://47.79.254.213:8001/health
```

### 10.4 Nginx é…ç½®

**åå‘ä»£ç†é…ç½®**:
```nginx
location /secret-channel {
    rewrite ^/secret-channel/(.*) /$1 break;
    proxy_pass https://generativelanguage.googleapis.com;
    proxy_set_header Host generativelanguage.googleapis.com;
    proxy_ssl_server_name on;
    proxy_ssl_verify off;
    proxy_connect_timeout 600s;
    proxy_send_timeout 600s;
    proxy_read_timeout 600s;
    client_max_body_size 100M;
}
```

### 10.5 iOS å®¢æˆ·ç«¯é…ç½®

**Info.plist**:
```xml
<key>NSAppTransportSecurity</key>
<dict>
    <key>NSExceptionDomains</key>
    <dict>
        <key>47.79.254.213</key>
        <dict>
            <key>NSExceptionAllowsInsecureHTTPLoads</key>
            <true/>
        </dict>
    </dict>
</dict>
```

**NetworkManager.swift**:
```swift
private let baseURL = "http://47.79.254.213:8001/api/v1"
```

---

## 11. å…³é”®é—®é¢˜è§£å†³æ–¹æ¡ˆ

### 11.1 å“åº”åºåˆ—åŒ–é—®é¢˜

**é—®é¢˜**: å®¢æˆ·ç«¯æ”¶åˆ° "Response could not be serialized, input data was nil or zero length"

**è§£å†³æ–¹æ¡ˆ**:
1. ä½¿ç”¨ `JSONResponse` ç¡®ä¿æ­£ç¡®åºåˆ—åŒ–
2. æ·»åŠ è¯¦ç»†çš„æ—¥å¿—è®°å½•
3. å…ˆè·å–åŸå§‹å“åº”æ•°æ®ç”¨äºè°ƒè¯•

**ä»£ç **:
```python
return JSONResponse(
    content=api_response.dict(),
    status_code=200,
    headers={"Content-Type": "application/json"}
)
```

### 11.2 å¼‚æ­¥åˆ†æä»»åŠ¡

**é—®é¢˜**: åˆ†æè€—æ—¶è¾ƒé•¿ï¼Œä¸èƒ½é˜»å¡ä¸Šä¼ å“åº”

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨ `asyncio.create_task()` å¯åŠ¨åå°ä»»åŠ¡
- ä¸Šä¼ æ¥å£ç«‹å³è¿”å›
- åˆ†æå®Œæˆåæ›´æ–°ä»»åŠ¡çŠ¶æ€

### 11.3 æ–‡ä»¶å¤„ç†

**é—®é¢˜**: UploadFile åªèƒ½è¯»å–ä¸€æ¬¡

**è§£å†³æ–¹æ¡ˆ**:
- å…ˆè¯»å–æ–‡ä»¶å†…å®¹åˆ°å†…å­˜
- ä¿å­˜åˆ°ä¸´æ—¶æ–‡ä»¶
- ä¼ é€’æ–‡ä»¶è·¯å¾„ç»™å¼‚æ­¥ä»»åŠ¡

### 11.4 Gemini API ä»£ç†

**é—®é¢˜**: å›½å†…æ— æ³•ç›´æ¥è®¿é—® Google API

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨ Nginx åå‘ä»£ç†
- è‡ªåŠ¨ URL é‡å†™
- é€šè¿‡ `googleapiclient.http.HttpRequest.execute` patch

### 11.5 é”™è¯¯å¤„ç†å’Œæ—¥å¿—

**é—®é¢˜**: è°ƒè¯•å›°éš¾ï¼Œé”™è¯¯ä¿¡æ¯ä¸æ˜ç¡®

**è§£å†³æ–¹æ¡ˆ**:
- è¯¦ç»†çš„æ—¥å¿—è®°å½•ï¼ˆDEBUG çº§åˆ«ï¼‰
- é”™è¯¯å †æ ˆè·Ÿè¸ª
- å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åŒé‡æ—¥å¿—

---

## é™„å½•

### A. ç‰ˆæœ¬å†å²

- **v0.1** (2026-01-09): åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºç¡€åŠŸèƒ½å®ç°
- **v0.2** (2026-01-14): ä¿®å¤å“åº”åºåˆ—åŒ–é—®é¢˜ï¼Œå®Œå–„æ–‡æ¡£

### B. å¾…å®ç°åŠŸèƒ½

- [ ] æ•°æ®åº“æŒä¹…åŒ–ï¼ˆPostgreSQLï¼‰
- [ ] ç”¨æˆ·è®¤è¯å’Œæˆæƒ
- [ ] å®æ—¶åˆ†æè¿›åº¦æ¨é€ï¼ˆWebSocketï¼‰
- [ ] éŸ³é¢‘æ–‡ä»¶å­˜å‚¨ï¼ˆOSS/S3ï¼‰
- [ ] ä»»åŠ¡æœç´¢åŠŸèƒ½
- [ ] æ‰¹é‡æ“ä½œ
- [ ] å¯¼å‡ºåŠŸèƒ½

### C. æ€§èƒ½ä¼˜åŒ–å»ºè®®

- [ ] å®ç° Redis ç¼“å­˜
- [ ] æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- [ ] CDN åŠ é€Ÿé™æ€èµ„æº
- [ ] éŸ³é¢‘æ–‡ä»¶å‹ç¼©
- [ ] åˆ†æç»“æœç¼“å­˜

### D. å®‰å…¨å»ºè®®

- [ ] HTTPS æ”¯æŒ
- [ ] API é™æµ
- [ ] æ–‡ä»¶ç±»å‹éªŒè¯
- [ ] æ–‡ä»¶å¤§å°é™åˆ¶
- [ ] ç”¨æˆ·æƒé™æ§åˆ¶

---

**æ–‡æ¡£ç»“æŸ**
