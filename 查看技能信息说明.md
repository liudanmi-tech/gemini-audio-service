# æŸ¥çœ‹æŠ€èƒ½ä¿¡æ¯è¯´æ˜

## Session ID
```
14979abf-41a7-4d00-a2f8-bfe0cebfffab
```

## æŸ¥çœ‹æ–¹å¼

### æ–¹å¼1: ç›´æ¥SSHæŸ¥çœ‹æ—¥å¿—

```bash
# è¿æ¥åˆ°æœåŠ¡å™¨
ssh admin@47.79.254.213

# æŸ¥çœ‹åŒ…å«è¯¥sessionçš„æ—¥å¿—
cd ~/gemini-audio-service
tail -2000 ~/gemini-audio-service.log | grep "14979abf-41a7-4d00-a2f8-bfe0cebfffab" | tail -50

# æŸ¥çœ‹ç­–ç•¥åˆ†æç”Ÿæˆæ—¥å¿—
tail -3000 ~/gemini-audio-service.log | grep -E "ç­–ç•¥åˆ†æç”Ÿæˆ|åœºæ™¯è¯†åˆ«|æŠ€èƒ½åŒ¹é…|v0.4|applied_skills|scene_category" | tail -100
```

### æ–¹å¼2: æŸ¥çœ‹æ•°æ®åº“

```bash
ssh admin@47.79.254.213
cd ~/gemini-audio-service
source venv/bin/activate

python3 << 'PYEOF'
import asyncio
import asyncpg
import os
from dotenv import load_dotenv
from urllib.parse import urlparse

load_dotenv()

async def check():
    database_url = os.getenv("DATABASE_URL", "")
    if "postgresql+asyncpg://" in database_url:
        database_url = database_url.replace("postgresql+asyncpg://", "postgresql://")
    
    parsed = urlparse(database_url)
    
    conn = await asyncpg.connect(
        host=parsed.hostname or 'localhost',
        port=parsed.port or 5432,
        user=parsed.username or 'postgres',
        password=parsed.password or 'postgres',
        database=parsed.path.lstrip('/') or 'gemini_audio_db'
    )
    
    session_id = "14979abf-41a7-4d00-a2f8-bfe0cebfffab"
    
    result = await conn.fetchrow("""
        SELECT 
            applied_skills,
            scene_category,
            scene_confidence,
            created_at
        FROM strategy_analysis
        WHERE session_id = $1
    """, session_id)
    
    if result:
        print("âœ… æ‰¾åˆ°ç­–ç•¥åˆ†ææ•°æ®")
        print(f"åˆ›å»ºæ—¶é—´: {result['created_at']}")
        print()
        print("ğŸ“Š æŠ€èƒ½ä¿¡æ¯:")
        print(f"  - åœºæ™¯ç±»åˆ«: {result['scene_category'] or 'N/A'}")
        print(f"  - åœºæ™¯ç½®ä¿¡åº¦: {result['scene_confidence'] or 'N/A'}")
        
        applied_skills = result['applied_skills'] or []
        print(f"  - åº”ç”¨æŠ€èƒ½æ•°é‡: {len(applied_skills)}")
        print()
        
        if applied_skills:
            for i, skill in enumerate(applied_skills, 1):
                print(f"  æŠ€èƒ½ {i}:")
                print(f"    - skill_id: {skill.get('skill_id', 'N/A')}")
                print(f"    - priority: {skill.get('priority', 'N/A')}")
                print(f"    - confidence: {skill.get('confidence', 'N/A')}")
            print()
            
            # è¯»å–æŠ€èƒ½è¯¦æƒ…
            print("ğŸ“„ æŠ€èƒ½è¯¦æƒ… (SKILL.md):")
            print("=" * 60)
            for skill in applied_skills:
                skill_id = skill.get('skill_id')
                if skill_id:
                    skill_path = f"skills/{skill_id}/SKILL.md"
                    try:
                        with open(skill_path, 'r', encoding='utf-8') as f:
                            content = f.read()
                            print(f"\n{'=' * 60}")
                            print(f"æŠ€èƒ½: {skill_id}")
                            print(f"{'=' * 60}")
                            print(content)
                            print()
                    except FileNotFoundError:
                        print(f"âŒ æŠ€èƒ½æ–‡ä»¶ä¸å­˜åœ¨: {skill_path}")
                    except Exception as e:
                        print(f"âŒ è¯»å–æŠ€èƒ½æ–‡ä»¶å¤±è´¥: {e}")
        else:
            print("  âš ï¸ æœªæ‰¾åˆ°åº”ç”¨æŠ€èƒ½ä¿¡æ¯")
    else:
        print("âŒ æœªæ‰¾åˆ°ç­–ç•¥åˆ†ææ•°æ®")
    
    await conn.close()

asyncio.run(check())
PYEOF
```

### æ–¹å¼3: ä½¿ç”¨è„šæœ¬

```bash
# æ‰§è¡Œæ£€æŸ¥è„šæœ¬
bash check_session_skills.sh
```

## é¢„æœŸè¾“å‡º

å¦‚æœç­–ç•¥åˆ†æä½¿ç”¨äº†v0.4æ¶æ„ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

1. **æ—¥å¿—è¾“å‡º**ï¼š
   ```
   ç­–ç•¥åˆ†æç”ŸæˆæˆåŠŸï¼ˆv0.4 æŠ€èƒ½åŒ–æ¶æ„ï¼‰
     - åœºæ™¯ç±»åˆ«: workplace (ç½®ä¿¡åº¦: 0.95)
     - åº”ç”¨æŠ€èƒ½: 1 ä¸ª
       - workplace_jungle: priority=100, confidence=0.95
   ```

2. **æ•°æ®åº“è¾“å‡º**ï¼š
   ```
   ğŸ“Š æŠ€èƒ½ä¿¡æ¯:
     - åœºæ™¯ç±»åˆ«: workplace
     - åœºæ™¯ç½®ä¿¡åº¦: 0.95
     - åº”ç”¨æŠ€èƒ½æ•°é‡: 1
     
     æŠ€èƒ½ 1:
       - skill_id: workplace_jungle
       - priority: 100
       - confidence: 0.95
   ```

3. **SKILL.mdå†…å®¹**ï¼š
   å®Œæ•´çš„æŠ€èƒ½æ–‡æ¡£å†…å®¹

## æ³¨æ„äº‹é¡¹

- å¦‚æœç­–ç•¥åˆ†ææ˜¯åœ¨v0.4æ¶æ„éƒ¨ç½²ä¹‹å‰ç”Ÿæˆçš„ï¼Œæ•°æ®åº“ä¸­çš„`applied_skills`ã€`scene_category`ã€`scene_confidence`å­—æ®µå¯èƒ½ä¸ºnull
- éœ€è¦é‡æ–°ç”Ÿæˆç­–ç•¥åˆ†ææ‰èƒ½çœ‹åˆ°æŠ€èƒ½ä¿¡æ¯
- ç¡®ä¿æœåŠ¡å™¨ä»£ç å·²æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
